{"version":3,"sources":["../../../node_modules/vexflow/src/notesubgroup.js"],"names":["NoteSubGroup","Modifier","CATEGORY","format","groups","state","length","width","i","group","preFormat","getWidth","left_shift","constructor","subNotes","setAttribute","note","index","position","Position","LEFT","forEach","subNote","ignore_ticks","preFormatted","formatter","Formatter","voice","Voice","num_beats","beat_value","resolution","Flow","RESOLUTION","setStrict","addTickables","getCategory","joinVoices","setWidth","getMinTotalWidth","setNote","draw","checkContext","getNote","Vex","RuntimeError","setRendered","alignSubNotesWithNote","setContext","context","drawWithStyle"],"mappings":"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","sourcesContent":["// [VexFlow](http://vexflow.com) - Copyright (c) Mohit Muthanna 2010.\n// Author Taehoon Moon 2016\n//\n// ## Description\n//\n// This file implements `NoteSubGroup` which is used to format and\n// render notes as a `Modifier`\n// ex) ClefNote, TimeSigNote and BarNote.\n\nimport { Vex } from './vex';\nimport { Flow } from './tables';\nimport { Modifier } from './modifier';\nimport { Formatter } from './formatter';\nimport { Voice } from './voice';\n\nexport class NoteSubGroup extends Modifier {\n  static get CATEGORY() { return 'notesubgroup'; }\n\n  // Arrange groups inside a `ModifierContext`\n  static format(groups, state) {\n    if (!groups || groups.length === 0) return false;\n\n    let width = 0;\n    for (let i = 0; i < groups.length; ++i) {\n      const group = groups[i];\n      group.preFormat();\n      width += group.getWidth();\n    }\n\n    state.left_shift += width;\n    return true;\n  }\n\n  constructor(subNotes) {\n    super();\n    this.setAttribute('type', 'NoteSubGroup');\n\n    this.note = null;\n    this.index = null;\n    this.position = Modifier.Position.LEFT;\n    this.subNotes = subNotes;\n    this.subNotes.forEach(subNote => { subNote.ignore_ticks = false; });\n    this.width = 0;\n    this.preFormatted = false;\n\n    this.formatter = new Formatter();\n    this.voice = new Voice({\n      num_beats: 4,\n      beat_value: 4,\n      resolution: Flow.RESOLUTION,\n    }).setStrict(false);\n\n    this.voice.addTickables(this.subNotes);\n\n    return this;\n  }\n\n  getCategory() { return NoteSubGroup.CATEGORY; }\n\n  preFormat() {\n    if (this.preFormatted) return;\n\n    this.formatter.joinVoices([this.voice]).format([this.voice], 0);\n    this.setWidth(this.formatter.getMinTotalWidth());\n    this.preFormatted = true;\n  }\n\n  setNote(note) {\n    this.note = note;\n  }\n  setWidth(width) {\n    this.width = width;\n  }\n  getWidth() {\n    return this.width;\n  }\n\n  draw() {\n    this.checkContext();\n\n    const note = this.getNote();\n\n    if (!(note && (this.index !== null))) {\n      throw new Vex.RuntimeError('NoAttachedNote',\n        \"Can't draw notes without a parent note and parent note index.\");\n    }\n\n    this.setRendered();\n    this.alignSubNotesWithNote(this.subNotes, note); // Modifier function\n\n    // Draw notes\n    this.subNotes.forEach(subNote => subNote.setContext(this.context).drawWithStyle());\n  }\n}\n"],"file":"notesubgroup.js"}